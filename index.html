<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Ruta Correntina Ultimate</title>
    <meta name="theme-color" content="#007AFF">
    <link rel="manifest" href="manifest.json">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.css" />
    
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="splash-screen">
        <div class="splash-content">
            <div class="logo-pulse"><i class="fas fa-map-marked-alt"></i></div>
            <h1>Ruta Correntina</h1>
            <p>TECHFIX EDITION v6.2</p>
        </div>
    </div>

    <div id="offline-banner"><i class="fas fa-wifi-slash"></i> Sin conexi√≥n - Guardando localmente</div>

    <div id="view-map" class="app-view active">
        <div id="map"></div>
        
        <div class="top-bar-floating">
            <div class="search-box-glass">
                <i class="fas fa-search"></i>
                <input type="text" id="buscador-input" placeholder="¬øA d√≥nde vamos hoy?" onkeyup="filtrarInput(this.value)">
                <div id="weather-widget" class="weather-in-bar">
                    <i class="fas fa-cloud-sun"></i> <span id="temp-val">--¬∞</span>
                </div>
            </div>
            
            <div class="filter-scroll">
                <button class="filter-pill active" onclick="filtrarBoton('todos', this)">Todo</button>
                <button class="filter-pill" onclick="filtrarBoton('abierto', this)">üïí Abierto</button>
                <button class="filter-pill" onclick="filtrarBoton('techfix', this)">üõ†Ô∏è TechFix</button> 
                <button class="filter-pill" onclick="filtrarBoton('turismo', this)">üì∏ Turismo</button>
                <button class="filter-pill" onclick="filtrarBoton('gastronomia', this)">üçî Comida</button>
                <button class="filter-pill" onclick="filtrarBoton('playa', this)">üèñÔ∏è Playa</button>
            </div>
        </div>

        <div class="map-controls">
            <button onclick="centrarMapaUsuario()" class="btn-float glass-btn" aria-label="Mi Ubicaci√≥n">
                <i class="fas fa-location-arrow"></i>
            </button>
        </div>

        <div id="nav-ui-bottom" class="nav-island">
            <div class="nav-content-wrapper">
                <div class="nav-data">
                    <div class="nav-time-big"><span id="nav-time">-- min</span></div>
                    <div class="nav-dist-small">
                        <i class="fas fa-walking"></i> <span id="nav-dist">-- km</span>
                    </div>
                </div>
                <div class="nav-actions">
                    <button onclick="finalizarViaje()" class="btn-end-trip"><i class="fas fa-times"></i></button>
                </div>
            </div>
        </div>
    </div>

    <div id="view-list" class="app-view">
        <div class="explore-header">
            <div class="header-texts">
                <small id="date-display">Cargando fecha...</small>
                <h1 id="greeting-display">Hola, Viajero</h1>
            </div>
            <div class="user-mini-badge" onclick="cambiarTab('profile')">
                <img id="header-avatar" src="https://ui-avatars.com/api/?name=Viajero&background=007AFF&color=fff" alt="Perfil">
            </div>
        </div>
        
        <div class="magic-container">
            <button class="btn-magic-wide" onclick="destinoMagico()">
                <div class="magic-icon"><i class="fas fa-wand-magic-sparkles"></i></div>
                <div class="magic-text">
                    <span>¬øA d√≥nde voy?</span>
                    <small>Sorpr√©ndeme ahora</small>
                </div>
                <i class="fas fa-chevron-right magic-arrow"></i>
            </button>
        </div>
        
        <div class="section-label">
            <h3>Circuitos R√°pidos</h3>
            <a onclick="filtrarBoton('todos', null)">Ver todo</a>
        </div>
        <div class="rutas-scroll-modern">
            <button onclick="iniciarRuta('techfix')" class="pill-cat techfix-glow">
                <i class="fas fa-wrench"></i> TechFix
            </button>
            <button onclick="iniciarRuta('historica')" class="pill-cat orange-glow">
                <i class="fas fa-landmark"></i> Hist√≥rico
            </button>
            <button onclick="iniciarRuta('costanera')" class="pill-cat blue-glow">
                <i class="fas fa-water"></i> Costanera
            </button>
            <button onclick="filtrarBoton('gastronomia', null)" class="pill-cat yellow-glow">
                <i class="fas fa-utensils"></i> Sabores
            </button>
        </div>
        
        <div class="section-label">
            <h3>Destacados hoy</h3>
            <button class="btn-refresh-mini" onclick="window.refreshFeed()"><i class="fas fa-sync-alt"></i></button>
        </div>
        
        <div id="feed-container" class="feed-grid-modern">
            </div>
        
        <div class="spacer-bottom"></div>
    </div>

    <div id="view-profile" class="app-view">
        
        <div id="auth-container">
            <div class="aurora-bg">
                <div class="blob blob-1"></div>
                <div class="blob blob-2"></div>
            </div>
            <div class="auth-card-glass">
                <div class="logo-3d"><i class="fas fa-fingerprint"></i></div>
                <h1>Identif√≠cate</h1>
                <p id="auth-header-text">Accede a tu pasaporte digital</p>
                <form onsubmit="handleSubmit(event)" class="auth-form">
                    <input type="email" id="email-input" class="input-minimal" placeholder="Email" required>
                    <input type="password" id="pass-input" class="input-minimal" placeholder="Contrase√±a" required>
                    <button type="submit" id="btn-submit" class="btn-premium-action">Entrar</button>
                </form>
                <button onclick="toggleAuthMode()" class="btn-text-link" id="toggle-text">Crear cuenta</button>
            </div>
        </div>

        <div id="user-profile-content" style="display:none;">
            <div class="premium-layout">
                
                <div class="profile-header">
                    <div class="user-info-row">
                        <div class="avatar-container">
                            <img id="user-avatar" src="" alt="Avatar">
                            <div class="level-bubble" id="level-badge">Lv. 1</div>
                        </div>
                        <div class="user-text">
                            <h2 id="user-name">Viajero</h2>
                            <span class="role-tag" id="badge-role">TURISTA</span>
                        </div>
                    </div>
                    <button class="btn-icon-circle" onclick="abrirEditarPerfil()"><i class="fas fa-cog"></i></button>
                </div>

                <div class="bento-grid">
                    
                    <div class="bento-card card-wallet-black" onclick="toggleCanje(true)">
                        <div class="card-bg-shine"></div>
                        <div class="wallet-top">
                            <i class="fas fa-chip"></i>
                            <span>TECHFIX ELITE</span>
                        </div>
                        <div class="wallet-balance">
                            <span id="tech-points">0</span> <small>PTS</small>
                        </div>
                        <div class="wallet-bottom">
                            <span>MEMBER SINCE 2026</span>
                            <i class="fab fa-cc-visa"></i>
                        </div>
                    </div>

                    <div class="bento-card stat-card">
                        <div class="icon-circle blue"><i class="fas fa-map-marker-alt"></i></div>
                        <span class="stat-num" id="stat-visitados">0</span>
                        <span class="stat-label">Lugares</span>
                    </div>

                    <div class="bento-card stat-card" onclick="toggleRanking(true)">
                        <div class="icon-circle gold"><i class="fas fa-trophy"></i></div>
                        <span class="stat-num" id="stat-badges-count">0</span>
                        <span class="stat-label">Ranking</span>
                    </div>

                    <div class="bento-card xp-card">
                        <div class="xp-header">
                            <span>Progreso de Nivel</span>
                            <span id="current-xp">0 / 500 XP</span>
                        </div>
                        <div class="progress-track-premium">
                            <div id="xp-bar-fill" class="progress-fill-premium"></div>
                        </div>
                    </div>
                </div>

                <div class="menu-group">
                    <div class="menu-item" onclick="toggleRanking(true)">
                        <div class="menu-left">
                            <div class="menu-icon color-1"><i class="fas fa-medal"></i></div>
                            <span class="menu-label">Mis Logros</span>
                        </div>
                        <i class="fas fa-chevron-right arrow"></i>
                    </div>
                    
                    <div class="menu-item">
                        <div class="menu-left">
                            <div class="menu-icon color-2"><i class="fas fa-images"></i></div>
                            <span class="menu-label">Galer√≠a Reciente</span>
                        </div>
                        <div class="menu-preview-imgs" id="passport-grid-mini"></div>
                        <i class="fas fa-chevron-right arrow"></i>
                    </div>

                    <div class="menu-item" id="dark-mode-toggle">
                        <div class="menu-left">
                            <div class="menu-icon color-3"><i class="fas fa-moon"></i></div>
                            <span class="menu-label">Modo Oscuro</span>
                        </div>
                        <div class="ios-switch"></div>
                    </div>
                </div>

                <button onclick="cerrarSesion()" class="btn-logout-premium">
                    <i class="fas fa-sign-out-alt"></i> Cerrar Sesi√≥n
                </button>
                
                <div class="spacer-bottom"></div>
            </div>
        </div>
    </div>

    <div id="modal-ranking" class="full-modal">
        <div class="modal-header">
            <h2>üèÜ Top Viajeros</h2>
            <button class="btn-close-modal" onclick="toggleRanking(false)"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body" id="ranking-list"></div>
    </div>

    <div id="modal-canje" class="full-modal">
        <div class="modal-header">
            <h2>üéüÔ∏è TechFix Store</h2>
            <button class="btn-close-modal" onclick="toggleCanje(false)"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
            <div class="points-display-large">
                <span id="canje-points">0</span> PTS
            </div>
            <div id="canje-list" class="coupons-grid"></div>
        </div>
    </div>

    <div id="chat-widget" class="chat-hidden">
        <div class="chat-header">
            <div class="chat-title">
                <i class="fas fa-robot"></i> Gu√≠a RutaBot
            </div>
            <button onclick="toggleChat()" class="close-chat"><i class="fas fa-chevron-down"></i></button>
        </div>
        
        <div id="chat-messages" class="chat-body">
            <div class="bot-msg">
                ¬°Hola, viajero! üßâ Soy tu gu√≠a virtual en Corrientes. 
                <br>Preg√∫ntame por lugares o si necesitas ayuda t√©cnica.
            </div>
        </div>
        
        <div class="chat-input-area">
            <input type="text" id="user-msg" placeholder="Escribe aqu√≠..." onkeypress="handleEnter(event)">
            <button onclick="enviarMensajeIA()" id="btn-send-ai">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <button onclick="toggleChat()" class="btn-chat-float">
        <i class="fas fa-comment-dots"></i>
    </button>

    <nav class="bottom-tab-bar">
        <button class="tab-btn active" onclick="cambiarTab('map')"><i class="fas fa-map-marked-alt"></i><span>Mapa</span></button>
        <button class="tab-btn" onclick="cambiarTab('list')"><i class="fas fa-compass"></i><span>Explorar</span></button>
        <button class="tab-btn" onclick="cambiarTab('profile')"><i class="fas fa-user"></i><span>Perfil</span></button>
    </nav>

    <div id="ficha-lugar"></div>
    <div id="toast-container"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>
    <script src="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.js"></script>
    <script type="module" src="script.js"></script>
</body>
</html>